h1. Certificate Generation

The reference implementation source tree provides a simple tool for creating certificate authorities CA, intermediate certificates authorities, and certificates.  The tool is located under the /java/agent/tools directory in the source tree and is named certGen.sh for unix/linux based systems and certGen.bat for Windows.

h2. Certificate Jargon

The direct project uses X509 certificates for SMIME operations and X509 certificate authorities for enforcing message trust.  A certificate authority is actually just a certificate with certain fields, policies, extensions.  Specifically a certificate authority is a certificate that can sign subordinate certificates using its private key and has its basic constraint policy set to true.  Root certificates are certificate authorities whose issuer and subfields are the same.  

Intermediate certificate authorities or intermediate signing certificates are certificate authorities that have been signed by a higher level certificate authority and whose issuer is the certificate that signed the intermediate certificate authority.  As you can see, certificates can form hierarchies called chains, and in some PKI infrastructures can become very complex.

A leaf certificate is a certificate that is at the bottom of a certificate hierarchy.  

In the direct project, certificate authorities are used as anchors for trust validation and leaf certificates are used for SMIME operations.

h2. Generation Steps

Numerous tools and commercial services are available for creating certificate chains, but they all follow the same general steps.  Take for example a very simple certificate chain:

# Generate and self sign a root certificate authority.
# Generate a PKCS10 certificate request along with a public/private key pair for a leaf certificate.
# Sign the PKCS10 request using with the certificate authority.

Open source tools such as openssl can be used to create your own certificate authorities and leaf certificates.  Other commercial services such as Verisign and Entrust can sign certificate requests for leaf certificate of intermediate signing certificates for a fee.  

h2. CertGen

The certificate generation processes can be cumbersome for inexperienced users or financially unfeasible for development purposes.  Tools such as openssl have a vast number of options and commands for creating a PKI infrastructures, but the syntax can steps can be daunting.  The CertGen application is a GUI based tool for creating a simple certificate chain for development purposes.  *NOTE* Certificates generated by this tool technically could be used for production HISP, however they do remotely meet the requirements of a good certificate practice statement.  They may, however, be appropriate for pilot and laboratory purposes. 

The following sections will walk you through creating certificate chains using the certGen tool.  *NOTE* You will need to checkout the reference implementation source tree first as described in the direct project software development [process|http://wiki.directproject.org/Software+Development+Process].  You will also need [maven|http://maven.apache.org/] installed to build the tool.  After checking out the source and installing maven, build the tools by running the following command under the /java/agent directory:

{code}
mvn clean install
{code} 

To run the tool, run the following command in the /java/agent/tools directory:

Windows:
{code}
certGen.bat
{code}

Unix/Linux/MAC

{code}
./certGen.sh
{code}

h3. Creating A Chain From Scratch

