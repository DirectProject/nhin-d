<Project DefaultTargets="build-all" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
	
	<!-- MSBuild documentation found at http://msdn.microsoft.com/en-us/library/0k6kkbsd.aspx -->
	
	<!-- Tigris - external\Tigris\MSBuildTasks.msi be installed http://msbuildtasks.tigris.org/ -->
	<!-- After installation the help file is at [Program Files]\MSBuild\MSBuildCommunityTasks\MSBuild.Community.Tasks.chm -->
	<!-- <Import Project="$(MSBuildExtensionsPath)\MSBuildCommunityTasks\MSBuild.Community.Tasks.Targets"/> -->
	
	<!-- this imports the xunit and xunitproject tasks -->
	<UsingTask AssemblyFile="external\xunit\xunit.runner.msbuild.dll" TaskName="Xunit.Runner.MSBuild.xunitproject" />

	<Target Name="build-all" DependsOnTargets="build-agent;build-gateway" />
	<Target Name="clean-all" DependsOnTargets="clean-agent;clean-gateway" />

	<Target Name="build-agent">
		<MSBuild Projects=".\build\build.sln" Targets="Build" Properties="Configuration=Debug" />
	</Target>

	<Target Name="clean-agent">
		<MSBuild Projects=".\build\build.sln" Targets="Clean" />
	</Target>

	<Target Name="build-gateway">
		<MSBuild Projects=".\gateway\gateway.sln" Targets="Build" Properties="Configuration=Debug" />
	</Target>

	<Target Name="clean-gateway">
		<!-- taken out for now due to failure
		<MSBuild Projects=".\gateway\gateway.sln" Targets="Clean" />
		 -->
	</Target>

	<!-- information on xUnit can be found at http://xunit.codeplex.com/ it is installed at external\xunit -->
	<Target Name="test" DependsOnTargets="build-all">
   <xunitproject ProjectFile="unittests\all.xunit" />
	</Target>
	
</Project>
